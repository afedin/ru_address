# PostgreSQL импорт данных ГАР

Пакет `ru_address` включает команду `pipeline`, которая автоматизирует полный цикл:

1. загрузка ZIP архива (HTTP/HTTPS/FTP или локальный путь);
2. генерация дампов таблиц напрямую из архива без распаковки;
3. параллельный импорт данных в PostgreSQL через `psql`.

## Требования

- установленный `psql` (PostgreSQL 12+);
- права на создание/изменение таблиц в целевой базе;
- достаточно свободного места для временных файлов (создаются в системной `TemporaryDirectory`).

## Быстрый старт

```shell
$ ru_address pipeline \
    --dsn postgresql://user:password@localhost/gar \
    --jobs 4 \
    https://example.org/gar.zip
```

Если предпочтительнее передавать параметры подключения отдельно:

```shell
$ ru_address pipeline \
    --host localhost \
    --port 5432 \
    --user gar_user \
    --password example \
    --database gar \
    /path/to/gar.zip
```

* `--table` позволяет ограничить список таблиц (по умолчанию загружаются все известные);
* `--region` фильтрует регионы (по умолчанию скачиваются все каталоги из архива);
* `--jobs` задаёт количество воркеров `ProcessPoolExecutor`;
* `--keep-zip` оставляет скачанный архив в рабочей директории.

В случае ошибки импорта соответствующий SQL-файл сохраняется рядом с текущим каталогом под именем `<REGION>_failed.sql` для диагностики.
